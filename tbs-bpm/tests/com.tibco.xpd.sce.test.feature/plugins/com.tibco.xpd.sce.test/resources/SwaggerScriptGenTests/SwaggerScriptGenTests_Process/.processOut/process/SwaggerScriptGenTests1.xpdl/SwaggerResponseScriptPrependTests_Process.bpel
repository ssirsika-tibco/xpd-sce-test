<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no"
    name="SwaggerResponseScriptPrependTests_Process"
    suppressJoinFailure="yes" tibex:bxVersion="11.6.0"
    tibex:dataFieldDescriptorClass="com.example.swaggerscriptgentests_process.SwaggerScriptGenTests_Process.SwaggerResponseScriptPrependTests_Process"
    tibex:dataFieldDescriptorScript="process-js/SwaggerScriptGenTests_Process/SwaggerResponseScriptPrependTests_Process/SwaggerResponseScriptPrependTests_Process.js"
    tibex:explicitCompensation="yes"
    tibex:xpdlId="_4CXIwIJNEe-Tg6dcesucaQ"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching"/>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:variables>
        <bpws:variable name="TextField04"
            tibex:xpdlId="_EEbMhYJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="Field11"
            tibex:xpdlId="_EEbMhoJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="Field12"
            tibex:xpdlId="_EEbMh4JOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="Field10"
            tibex:xpdlId="_EEbMiIJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextField02"
            tibex:xpdlId="_EEbMiYJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextField01"
            tibex:xpdlId="_EEbMioJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextArray" tibex:array="yes"
            tibex:xpdlId="_EEbMi4JOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextField09"
            tibex:xpdlId="_EEbMjIJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextField03"
            tibex:xpdlId="_EEbMjYJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="IntegerField01"
            tibex:xpdlId="_EEbMjoJOEe-Tg6dcesucaQ" type="xsd:long"/>
        <bpws:variable name="TextField08"
            tibex:xpdlId="_EEbMj4JOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextField05"
            tibex:xpdlId="_EEbMkIJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TextField07"
            tibex:xpdlId="_EEbMkYJOEe-Tg6dcesucaQ" type="xsd:string"/>
        <bpws:variable name="TagsField" tibex:array="yes"
            tibex:class="com.example.SwaggerScriptGenTests_data.Tag"
            tibex:classVersion="1" tibex:xpdlId="_EEbMkoJOEe-Tg6dcesucaQ"/>
        <bpws:variable name="TextField06"
            tibex:xpdlId="_jSr_QIJOEe-Tg6dcesucaQ" type="xsd:string"/>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_A_UT4Ie4Ee-WYIK8ko4sbQ">
        <bpws:links>
            <bpws:link name="StartEvent to singleSuccessResponsePO" tibex:xpdlId="_GTQ-YYJVEe-Tg6dcesucaQ"/>
            <bpws:link
                name="singleSuccessResponsePO to _Lc1gQIJVEe-Tg6dcesucaQ" tibex:xpdlId="_Lc1gQ4JVEe-Tg6dcesucaQ"/>
            <bpws:link
                name="_Lc1gQIJVEe-Tg6dcesucaQ to _MCqKIIJVEe-Tg6dcesucaQ" tibex:xpdlId="_MCqKI4JVEe-Tg6dcesucaQ"/>
            <bpws:link name="_MCqKIIJVEe-Tg6dcesucaQ to EndEvent" tibex:xpdlId="_T4NHs4SSEe-krIHjRz4Faw"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="StartEvent" tibex:type="startEvent"
                tibex:xpdlId="_5vdjw4JNEe-Tg6dcesucaQ" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="StartEvent to singleSuccessResponsePO"/>
                </bpws:sources>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:empty name="EndEvent" tibex:migrationAllowed="yes"
            tibex:type="endEvent" tibex:xpdlId="_5vdjxIJNEe-Tg6dcesucaQ">
            <bpws:targets>
                <bpws:target linkName="_MCqKIIJVEe-Tg6dcesucaQ to EndEvent"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:invoke name="singleSuccessResponsePO"
            tibex:invokeType="REST" tibex:migrationAllowed="yes"
            tibex:sharedResourceName="Swagger Petstore"
            tibex:sharedResourceType="HTTPClient"
            tibex:type="serviceTask" tibex:xpdlId="_GTQ-YIJVEe-Tg6dcesucaQ">
            <tibex:restResponseScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Get response data.
var REST_STATUS_CODE = REST_RESPONSE.getStatus();

var REST_HEADER_200_X_Rate_Limit = null;
var REST_HEADER_200_X_Expires_After = null;
var REST_PAYLOAD_200 = null;

var $REST_RESPONSE_DATA = null;
try {
    if (REST_RESPONSE.getData() != null) {
        $REST_RESPONSE_DATA = JSON.parse(REST_RESPONSE.getData());
    }
} catch(ex) {

    // Wrap exception in something more obvious if the response data parse fails (probably not JSON format)
    throw "    JSON Response payload parsing failed (not formatted correctly as JSON string?).\n" + 
        "        Parser Exception: " + ex.message + "\n---------------------------------\n" + 
        "        Payload Text: \n" + REST_RESPONSE.getData() + "\n---------------------------------\n";
    
}

if (REST_STATUS_CODE == '200') {
    REST_HEADER_200_X_Rate_Limit = REST_RESPONSE.getHeader('X-Rate-Limit');
    REST_HEADER_200_X_Expires_After = REST_RESPONSE.getHeader('X-Expires-After');
    REST_PAYLOAD_200 = $REST_RESPONSE_DATA;
}


function pathExists(rootObject, objectPath) { 
    if (objectPath && elementExists(rootObject)) {
        var lastChildStartIdx = objectPath.lastIndexOf('[\'');
        var paths = [];
        // dot-notation
        if (lastChildStartIdx === -1) {       
            // Split and remove the first element because it is the root object e.g. 'obj.child.grandchild' --> obj is the root object
            paths = objectPath.split(".").slice(1); 
        } else {
            // Square-bracket notation
            while(lastChildStartIdx !== -1){            
                var lastChildEndIdx = objectPath.lastIndexOf('\']');
                // Add last child
                paths.unshift(objectPath.substring(lastChildStartIdx + 2, lastChildEndIdx));
                // Update path
                objectPath = objectPath.substring(0, lastChildStartIdx);
                lastChildStartIdx = objectPath.lastIndexOf('[\'');
            }
        }        
        var pathElement = paths.reduce(function(obj, prop){       
            return (elementExists(obj) && elementExists(obj[prop])) ? obj[prop] : undefined;
        }, rootObject);
        return elementExists(pathElement);
    }
    return false;
}
function elementExists(element){
    return typeof(element) !== 'undefined' && element !== null;
}


]]></tibex:restResponseScript>
            <tibex:restRequestScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var REST_PAYLOAD = null;


function pathExists(rootObject, objectPath) { 
    if (objectPath && elementExists(rootObject)) {
        var lastChildStartIdx = objectPath.lastIndexOf('[\'');
        var paths = [];
        // dot-notation
        if (lastChildStartIdx === -1) {       
            // Split and remove the first element because it is the root object e.g. 'obj.child.grandchild' --> obj is the root object
            paths = objectPath.split(".").slice(1); 
        } else {
            // Square-bracket notation
            while(lastChildStartIdx !== -1){            
                var lastChildEndIdx = objectPath.lastIndexOf('\']');
                // Add last child
                paths.unshift(objectPath.substring(lastChildStartIdx + 2, lastChildEndIdx));
                // Update path
                objectPath = objectPath.substring(0, lastChildStartIdx);
                lastChildStartIdx = objectPath.lastIndexOf('[\'');
            }
        }        
        var pathElement = paths.reduce(function(obj, prop){       
            return (elementExists(obj) && elementExists(obj[prop])) ? obj[prop] : undefined;
        }, rootObject);
        return elementExists(pathElement);
    }
    return false;
}
function elementExists(element){
    return typeof(element) !== 'undefined' && element !== null;
}

// Build request URI.
function __filterQueryParams(__all_params){
    return __all_params.filter(function(__filter_param){
        return __filter_param.mandatory||eval(__filter_param.path)!=null;
    });
}
function __encodeQueryParams(__all_params){
    var __filtered_params = __filterQueryParams(__all_params);
    var __mapped_params = __filtered_params.map(function(__filtered_param){
        return __filtered_param.name+'='+encodeURIComponent(eval(__filtered_param.path));
    });
    return __filtered_params.length>0?'?'+__mapped_params.join('&'):'';
}
var REST_REQUEST_URI = encodeURI('/singleSuccessResponse');

// Set request fields.
REST_REQUEST.setHeader('Content-Type','application/json');
REST_REQUEST.setHeader('Accept','application/json');
REST_REQUEST.setUrl(REST_REQUEST_URI);
REST_REQUEST.setMethod('POST');
if (REST_PAYLOAD) {
    REST_REQUEST.setData(JSON.stringify(REST_PAYLOAD));
}


]]></tibex:restRequestScript>
            <bpws:targets>
                <bpws:target linkName="StartEvent to singleSuccessResponsePO"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="singleSuccessResponsePO to _Lc1gQIJVEe-Tg6dcesucaQ"/>
            </bpws:sources>
        </bpws:invoke>
        <bpws:invoke name="singleSuccessDefaultResponseNoMappings"
            tibex:invokeType="REST" tibex:migrationAllowed="yes"
            tibex:sharedResourceName="Swagger Petstore"
            tibex:sharedResourceType="HTTPClient"
            tibex:type="serviceTask" tibex:xpdlId="_Lc1gQIJVEe-Tg6dcesucaQ">
            <tibex:restResponseScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Get response data.
var REST_STATUS_CODE = REST_RESPONSE.getStatus();

var REST_HEADER_default_DefaultHdr_201_1 = null;
var REST_PAYLOAD_default = null;

var $REST_RESPONSE_DATA = null;
try {
    if (REST_RESPONSE.getData() != null) {
        $REST_RESPONSE_DATA = JSON.parse(REST_RESPONSE.getData());
    }
} catch(ex) {

    // Wrap exception in something more obvious if the response data parse fails (probably not JSON format)
    throw "    JSON Response payload parsing failed (not formatted correctly as JSON string?).\n" + 
        "        Parser Exception: " + ex.message + "\n---------------------------------\n" + 
        "        Payload Text: \n" + REST_RESPONSE.getData() + "\n---------------------------------\n";
    
}

REST_HEADER_default_DefaultHdr_201_1 = REST_RESPONSE.getHeader('DefaultHdr_201_1');
REST_PAYLOAD_default = $REST_RESPONSE_DATA;


function pathExists(rootObject, objectPath) { 
    if (objectPath && elementExists(rootObject)) {
        var lastChildStartIdx = objectPath.lastIndexOf('[\'');
        var paths = [];
        // dot-notation
        if (lastChildStartIdx === -1) {       
            // Split and remove the first element because it is the root object e.g. 'obj.child.grandchild' --> obj is the root object
            paths = objectPath.split(".").slice(1); 
        } else {
            // Square-bracket notation
            while(lastChildStartIdx !== -1){            
                var lastChildEndIdx = objectPath.lastIndexOf('\']');
                // Add last child
                paths.unshift(objectPath.substring(lastChildStartIdx + 2, lastChildEndIdx));
                // Update path
                objectPath = objectPath.substring(0, lastChildStartIdx);
                lastChildStartIdx = objectPath.lastIndexOf('[\'');
            }
        }        
        var pathElement = paths.reduce(function(obj, prop){       
            return (elementExists(obj) && elementExists(obj[prop])) ? obj[prop] : undefined;
        }, rootObject);
        return elementExists(pathElement);
    }
    return false;
}
function elementExists(element){
    return typeof(element) !== 'undefined' && element !== null;
}


]]></tibex:restResponseScript>
            <tibex:restRequestScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var REST_PAYLOAD = null;


function pathExists(rootObject, objectPath) { 
    if (objectPath && elementExists(rootObject)) {
        var lastChildStartIdx = objectPath.lastIndexOf('[\'');
        var paths = [];
        // dot-notation
        if (lastChildStartIdx === -1) {       
            // Split and remove the first element because it is the root object e.g. 'obj.child.grandchild' --> obj is the root object
            paths = objectPath.split(".").slice(1); 
        } else {
            // Square-bracket notation
            while(lastChildStartIdx !== -1){            
                var lastChildEndIdx = objectPath.lastIndexOf('\']');
                // Add last child
                paths.unshift(objectPath.substring(lastChildStartIdx + 2, lastChildEndIdx));
                // Update path
                objectPath = objectPath.substring(0, lastChildStartIdx);
                lastChildStartIdx = objectPath.lastIndexOf('[\'');
            }
        }        
        var pathElement = paths.reduce(function(obj, prop){       
            return (elementExists(obj) && elementExists(obj[prop])) ? obj[prop] : undefined;
        }, rootObject);
        return elementExists(pathElement);
    }
    return false;
}
function elementExists(element){
    return typeof(element) !== 'undefined' && element !== null;
}

// Build request URI.
function __filterQueryParams(__all_params){
    return __all_params.filter(function(__filter_param){
        return __filter_param.mandatory||eval(__filter_param.path)!=null;
    });
}
function __encodeQueryParams(__all_params){
    var __filtered_params = __filterQueryParams(__all_params);
    var __mapped_params = __filtered_params.map(function(__filtered_param){
        return __filtered_param.name+'='+encodeURIComponent(eval(__filtered_param.path));
    });
    return __filtered_params.length>0?'?'+__mapped_params.join('&'):'';
}
var REST_REQUEST_URI = encodeURI('/singleSuccessDefaultResponse');

// Set request fields.
REST_REQUEST.setHeader('Content-Type','application/json');
REST_REQUEST.setHeader('Accept','application/json');
REST_REQUEST.setUrl(REST_REQUEST_URI);
REST_REQUEST.setMethod('POST');
if (REST_PAYLOAD) {
    REST_REQUEST.setData(JSON.stringify(REST_PAYLOAD));
}


]]></tibex:restRequestScript>
            <bpws:targets>
                <bpws:target linkName="singleSuccessResponsePO to _Lc1gQIJVEe-Tg6dcesucaQ"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="_Lc1gQIJVEe-Tg6dcesucaQ to _MCqKIIJVEe-Tg6dcesucaQ"/>
            </bpws:sources>
        </bpws:invoke>
        <bpws:invoke name="multipleSuccessAndDefaultResponseNoMappings"
            tibex:invokeType="REST" tibex:migrationAllowed="yes"
            tibex:sharedResourceName="Swagger Petstore"
            tibex:sharedResourceType="HTTPClient"
            tibex:type="serviceTask" tibex:xpdlId="_MCqKIIJVEe-Tg6dcesucaQ">
            <tibex:restResponseScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Get response data.
var REST_STATUS_CODE = REST_RESPONSE.getStatus();

var REST_HEADER_200_X_Rate_Limit = null;
var REST_HEADER_200_X_Expires_After = null;
var REST_PAYLOAD_200 = null;
var REST_HEADER_234_Hdr_234_1 = null;
var REST_PAYLOAD_234 = null;
var REST_HEADER_default_DefaultHdr_Default_1 = null;
var REST_PAYLOAD_default = null;

var $REST_RESPONSE_DATA = null;
try {
    if (REST_RESPONSE.getData() != null) {
        $REST_RESPONSE_DATA = JSON.parse(REST_RESPONSE.getData());
    }
} catch(ex) {

    // Wrap exception in something more obvious if the response data parse fails (probably not JSON format)
    throw "    JSON Response payload parsing failed (not formatted correctly as JSON string?).\n" + 
        "        Parser Exception: " + ex.message + "\n---------------------------------\n" + 
        "        Payload Text: \n" + REST_RESPONSE.getData() + "\n---------------------------------\n";
    
}

if (REST_STATUS_CODE == '200') {
    REST_HEADER_200_X_Rate_Limit = REST_RESPONSE.getHeader('X-Rate-Limit');
    REST_HEADER_200_X_Expires_After = REST_RESPONSE.getHeader('X-Expires-After');
    REST_PAYLOAD_200 = $REST_RESPONSE_DATA;
}
else if (REST_STATUS_CODE == '234') {
    REST_HEADER_234_Hdr_234_1 = REST_RESPONSE.getHeader('Hdr_234_1');
    REST_PAYLOAD_234 = $REST_RESPONSE_DATA;
}
else {
    REST_HEADER_default_DefaultHdr_Default_1 = REST_RESPONSE.getHeader('DefaultHdr_Default_1');
    REST_PAYLOAD_default = $REST_RESPONSE_DATA;
}


function pathExists(rootObject, objectPath) { 
    if (objectPath && elementExists(rootObject)) {
        var lastChildStartIdx = objectPath.lastIndexOf('[\'');
        var paths = [];
        // dot-notation
        if (lastChildStartIdx === -1) {       
            // Split and remove the first element because it is the root object e.g. 'obj.child.grandchild' --> obj is the root object
            paths = objectPath.split(".").slice(1); 
        } else {
            // Square-bracket notation
            while(lastChildStartIdx !== -1){            
                var lastChildEndIdx = objectPath.lastIndexOf('\']');
                // Add last child
                paths.unshift(objectPath.substring(lastChildStartIdx + 2, lastChildEndIdx));
                // Update path
                objectPath = objectPath.substring(0, lastChildStartIdx);
                lastChildStartIdx = objectPath.lastIndexOf('[\'');
            }
        }        
        var pathElement = paths.reduce(function(obj, prop){       
            return (elementExists(obj) && elementExists(obj[prop])) ? obj[prop] : undefined;
        }, rootObject);
        return elementExists(pathElement);
    }
    return false;
}
function elementExists(element){
    return typeof(element) !== 'undefined' && element !== null;
}


]]></tibex:restResponseScript>
            <tibex:restRequestScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var REST_PAYLOAD = null;


function pathExists(rootObject, objectPath) { 
    if (objectPath && elementExists(rootObject)) {
        var lastChildStartIdx = objectPath.lastIndexOf('[\'');
        var paths = [];
        // dot-notation
        if (lastChildStartIdx === -1) {       
            // Split and remove the first element because it is the root object e.g. 'obj.child.grandchild' --> obj is the root object
            paths = objectPath.split(".").slice(1); 
        } else {
            // Square-bracket notation
            while(lastChildStartIdx !== -1){            
                var lastChildEndIdx = objectPath.lastIndexOf('\']');
                // Add last child
                paths.unshift(objectPath.substring(lastChildStartIdx + 2, lastChildEndIdx));
                // Update path
                objectPath = objectPath.substring(0, lastChildStartIdx);
                lastChildStartIdx = objectPath.lastIndexOf('[\'');
            }
        }        
        var pathElement = paths.reduce(function(obj, prop){       
            return (elementExists(obj) && elementExists(obj[prop])) ? obj[prop] : undefined;
        }, rootObject);
        return elementExists(pathElement);
    }
    return false;
}
function elementExists(element){
    return typeof(element) !== 'undefined' && element !== null;
}

// Build request URI.
function __filterQueryParams(__all_params){
    return __all_params.filter(function(__filter_param){
        return __filter_param.mandatory||eval(__filter_param.path)!=null;
    });
}
function __encodeQueryParams(__all_params){
    var __filtered_params = __filterQueryParams(__all_params);
    var __mapped_params = __filtered_params.map(function(__filtered_param){
        return __filtered_param.name+'='+encodeURIComponent(eval(__filtered_param.path));
    });
    return __filtered_params.length>0?'?'+__mapped_params.join('&'):'';
}
var REST_REQUEST_URI = encodeURI('/multipleSuccessAndDefaultResponse');

// Set request fields.
REST_REQUEST.setHeader('Content-Type','application/json');
REST_REQUEST.setHeader('Accept','application/json');
REST_REQUEST.setUrl(REST_REQUEST_URI);
REST_REQUEST.setMethod('POST');
if (REST_PAYLOAD) {
    REST_REQUEST.setData(JSON.stringify(REST_PAYLOAD));
}


]]></tibex:restRequestScript>
            <bpws:targets>
                <bpws:target linkName="_Lc1gQIJVEe-Tg6dcesucaQ to _MCqKIIJVEe-Tg6dcesucaQ"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="_MCqKIIJVEe-Tg6dcesucaQ to EndEvent"/>
            </bpws:sources>
        </bpws:invoke>
    </bpws:flow>
</bpws:process>
